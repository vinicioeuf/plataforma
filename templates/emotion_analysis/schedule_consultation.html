{% extends 'base.html' %}

{% block title %}Agendar Consulta - EmotionAI{% endblock %}

{% block content %}
<div class="container pb-5">
    <div class="row justify-content-center">
        <div class="col-lg-6">
            <div class="card p-4">
                <h2 class="text-center mb-4">
                    <i class="bi bi-calendar-plus"></i>
                    Agendar Nova Consulta
                </h2>
                
                <form method="post">
                    {% csrf_token %}
                    
                    <!-- Profissional -->
                    <div class="mb-3">
                        <label for="professional" class="form-label">
                            <i class="bi bi-person-badge"></i> Profissional
                        </label>
                        <select class="form-select" id="professional" name="professional" required>
                            <option value="">Selecione um profissional</option>
                            {% for professional in professionals %}
                                <option value="{{ professional.id }}">
                                    Dr(a). {{ professional.get_full_name|default:professional.username }}
                                    {% if professional.userprofile.specialization %} - {{ professional.userprofile.specialization }}{% endif %}
                                </option>
                            {% endfor %}
                        </select>
                    </div>
                    
                    <!-- Título -->
                    <div class="mb-3">
                        <label for="title" class="form-label">
                            <i class="bi bi-card-text"></i> Título da Consulta
                        </label>
                        <input type="text" class="form-control" id="title" name="title" 
                               placeholder="Ex: Consulta inicial, Acompanhamento..." value="Consulta">
                    </div>
                    
                    <!-- Descrição -->
                    <div class="mb-3">
                        <label for="description" class="form-label">
                            <i class="bi bi-file-text"></i> Motivo/Observações
                        </label>
                        <textarea class="form-control" id="description" name="description" rows="3"
                                  placeholder="Descreva brevemente o motivo da consulta ou observações importantes..."></textarea>
                    </div>
                    
                    <!-- Data e Hora -->
                    <div class="row g-3 mb-4">
                        <div class="col-md-6">
                            <label for="date" class="form-label">
                                <i class="bi bi-calendar"></i> Data
                            </label>
                            <input type="date" class="form-control" id="date" name="date" required
                                   min="{{ today|date:'Y-m-d' }}">
                        </div>
                        <div class="col-md-6">
                            <label for="time" class="form-label">
                                <i class="bi bi-clock"></i> Horário
                            </label>
                            <select class="form-select" id="time" name="time" required>
                                <option value="">Selecione o horário</option>
                                <option value="08:00">08:00</option>
                                <option value="08:30">08:30</option>
                                <option value="09:00">09:00</option>
                                <option value="09:30">09:30</option>
                                <option value="10:00">10:00</option>
                                <option value="10:30">10:30</option>
                                <option value="11:00">11:00</option>
                                <option value="11:30">11:30</option>
                                <option value="14:00">14:00</option>
                                <option value="14:30">14:30</option>
                                <option value="15:00">15:00</option>
                                <option value="15:30">15:30</option>
                                <option value="16:00">16:00</option>
                                <option value="16:30">16:30</option>
                                <option value="17:00">17:00</option>
                                <option value="17:30">17:30</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="alert alert-info">
                        <i class="bi bi-info-circle"></i>
                        <strong>Importante:</strong> Esta é uma plataforma básica de telepsicologia. 
                        O profissional entrará em contato para confirmar o horário e as instruções para a consulta.
                    </div>
                    
                    <div class="text-center">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="bi bi-check-circle"></i>
                            Agendar Consulta
                        </button>
                        <a href="{% url 'consultations' %}" class="btn btn-outline-secondary btn-lg">
                            <i class="bi bi-arrow-left"></i>
                            Voltar
                        </a>
                    </div>
                </form>
            </div>
            
            <!-- Dicas -->
            <div class="card mt-4 p-3">
                <h6 class="fw-bold text-primary">
                    <i class="bi bi-lightbulb"></i> Dicas para sua consulta
                </h6>
                <ul class="small text-muted mb-0">
                    <li>Escolha um horário em que você possa estar em um ambiente calmo</li>
                    <li>Prepare uma lista de pontos que gostaria de discutir</li>
                    <li>Certifique-se de ter uma conexão estável de internet</li>
                    <li>Tenha água próximo e esteja confortável</li>
                </ul>
            </div>
        </div>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Definir data mínima como hoje
    const dateInput = document.getElementById('date');
    const today = new Date().toISOString().split('T')[0];
    dateInput.min = today;
    
    // Se há um parâmetro professional na URL, selecionar automaticamente
    const urlParams = new URLSearchParams(window.location.search);
    const professionalId = urlParams.get('professional');
    if (professionalId) {
        const professionalSelect = document.getElementById('professional');
        professionalSelect.value = professionalId;
    }
});
</script>
{% endblock %}